#!/usr/bin/env bash
PACKAGE_DIR=${PACKAGE_DIR:-$PWD}
git submodule update --init --recursive
mkdir -p $PACKAGE_DIR/3rdparty/poppler/build
cd $PACKAGE_DIR/3rdparty/poppler/build
echo "${DUB_BUILD_TYPE^} build of $DUB_PACKAGE:$DUB_PACKAGE_VERSION"
cmake -DBUILD_GTK_TESTS=OFF -DBUILD_QT5_TESTS=OFF -DBUILD_QT6_TESTS=OFF -DBUILD_CPP_TESTS=OFF \
      -DBUILD_MANUAL_TESTS=OFF -DENABLE_BOOST=OFF -DENABLE_UTILS=OFF -DENABLE_CPP=OFF \
      -DENABLE_GLIB=ON -DENABLE_GOBJECT_INTROSPECTION=OFF -DENABLE_QT5=OFF -DENABLE_QT6=OFF \
      -DENABLE_LIBCURL=OFF -DBUILD_SHARED_LIBS=ON -DRUN_GPERF_IF_PRESENT=OFF \
      -DENABLE_LIBOPENJPEG=openjpeg2 \
      -DCMAKE_BUILD_TYPE=${DUB_BUILD_TYPE^} \
      ..
make
